<!DOCTYPE html>
<html lang="uk" data-theme="dark">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–¢–°–ù –ù–æ–≤–∏–Ω–∏</title>
  <style>
      :root {
    --bg-color: #ffffff;
    --text-color: #333333;
    --accent-color: #c62828;
    --accent-color-hover: #8e0000;
    --success-color: #4caf50;
    --info-color: #2196f3;
    --card-bg: #f9f9f9;
    --card-bg-blur: rgba(255, 255, 255, 0.9);
    --border-color: #e0e0e0;
    --header-height: 70px;
    --sidebar-width: 240px;
    --font-primary: 'Segoe UI', 'Nunito', Tahoma, Geneva, Verdana, sans-serif;
    --shadow-light: 0 4px 12px rgba(198, 40, 40, 0.1);
    --shadow-hover: 0 8px 24px rgba(198, 40, 40, 0.15);
    --glass-blur: blur(16px);
    --transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    --gradient: linear-gradient(135deg, #ffffff 0%, #ffecec 100%);
    --sidebar-shadow: 0 8px 32px rgba(150, 10, 10, 0.08);
    --modal-bg: rgba(0, 0, 0, 0.5);
    --blur: blur(12px);
  }

  [data-theme="dark"] {
    --bg-color: #1a1a1a;
    --text-color: #f0f0f0;
    --accent-color: #ff5252;
    --accent-color-hover: #ff1a1a;
    --success-color: #66bb6a;
    --info-color: #42a5f5;
    --card-bg: #2a2a2a;
    --card-bg-blur: rgba(40, 40, 40, 0.8);
    --border-color: #444444;
    --shadow-light: 0 4px 12px rgba(0, 0, 0, 0.25);
    --shadow-hover: 0 8px 24px rgba(255, 82, 82, 0.25);
    --gradient: linear-gradient(135deg, #1a1a1a 0%, #2a0a0a 100%);
    --sidebar-shadow: 0 8px 32px rgba(0, 0, 0, 0.35);
    --modal-bg: rgba(0, 0, 0, 0.7);
  }

  * {
    box-sizing: border-box;
    scroll-behavior: smooth;
    margin: 0;
    padding: 0;
  }

  body {
    font-family: var(--font-primary);
    color: var(--text-color);
    background-color: var(--bg-color);
    min-height: 100vh;
    transition: background 0.5s, color 0.3s;
    background: var(--gradient);
    background-attachment: fixed;
    overflow-x: hidden;
    display: flex;
    flex-direction: column;
    line-height: 1.6;
  }

  /* HEADER STYLES */
  header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: var(--header-height);
    background: white;
    color: #c62828;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 2rem;
    font-weight: 800;
    font-size: 1.8rem;
    letter-spacing: 0.01em;
    user-select: none;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    z-index: 2000;
    border-bottom: 3px solid #c62828;
  }

  [data-theme="dark"] header {
    background: #222;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
    border-bottom: 3px solid #ff5252;
  }

  .header-controls {
    display: flex;
    gap: 1rem;
    align-items: center;
  }

  #menu-toggle {
    cursor: pointer;
    font-size: 1.8rem;
    background: transparent;
    color: var(--accent-color);
    padding: 0.5rem;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 45px;
    height: 45px;
    transition: all var(--transition);
  }

  #menu-toggle:hover {
    background: rgba(198, 40, 40, 0.1);
  }

  .header-btn {
    background: white;
    color: #c62828;
    border: 2px solid #c62828;
    font-weight: 700;
    font-size: 1rem;
    border-radius: 10px;
    padding: 0.5rem 1.2rem;
    cursor: pointer;
    transition: all var(--transition);
    box-shadow: 0 2px 6px rgba(198, 40, 40, 0.1);
    line-height: 1.35;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  [data-theme="dark"] .header-btn {
    background: #333;
    color: #ff5252;
    border: 2px solid #ff5252;
  }

  .header-btn:hover,
  .header-btn.active {
    background: #c62828;
    color: #fff;
    transform: translateY(-2px);
  }

  [data-theme="dark"] .header-btn:hover {
    background: #ff5252;
  }

  /* SIDEBAR STYLES */
  #sidebar {
    width: var(--sidebar-width);
    min-width: 200px;
    background: white;
    border-left: 1px solid #e0e0e0;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    padding: 1.5rem 1rem;
    position: fixed;
    top: var(--header-height);
    right: -250px;
    bottom: 0;
    box-shadow: var(--sidebar-shadow);
    z-index: 1000;
    transition: right 0.4s;
    overflow-y: auto;
  }

  [data-theme="dark"] #sidebar {
    background: #2a2a2a;
    border-left: 1px solid #444;
  }

  #sidebar.open {
    right: 0;
  }

  .sidebar-btn {
    background: white;
    color: #333;
    text-align: left;
    padding: 1rem 1.5rem;
    font-size: 1.1rem;
    border-radius: 10px;
    cursor: pointer;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 1rem;
    transition: all var(--transition);
    border: 1px solid #e0e0e0;
    box-shadow: var(--shadow-light);
  }

  [data-theme="dark"] .sidebar-btn {
    background: #333;
    color: #f0f0f0;
    border: 1px solid #444;
  }

  .sidebar-btn.active,
  .sidebar-btn:hover {
    background: #c62828;
    color: white;
    transform: translateX(-5px);
    border-color: #c62828;
  }

  [data-theme="dark"] .sidebar-btn.active,
  [data-theme="dark"] .sidebar-btn:hover {
    background: #ff5252;
  }

  /* MAIN CONTENT */
  main {
    padding: calc(var(--header-height) + 2rem) 5% 2rem 5%;
    max-width: 1200px;
    min-height: 90vh;
    user-select: text;
    transition: margin 0.3s;
    display: flex;
    flex-direction: column;
    width: 100%;
    margin: 0 auto;
  }

  section {
    display: none;
    animation: fadeIn 0.5s;
    width: 100%;
    background: var(--card-bg);
    border-radius: 16px;
    padding: 2rem;
    box-shadow: var(--shadow-light);
    border: 1px solid var(--border-color);
  }

  section.active {
    display: block;
  }

  .section-title {
    color: #c62828;
    font-size: 1.8rem;
    margin-bottom: 1.5rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid #c62828;
    display: flex;
    align-items: center;
    gap: 0.8rem;
  }

  [data-theme="dark"] .section-title {
    color: #ff5252;
    border-bottom: 2px solid #ff5252;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* FORM STYLES */
  .tag-filter-container {
    margin-bottom: 2rem;
    background: var(--card-bg);
    border-radius: 16px;
    padding: 1.5rem;
    box-shadow: var(--shadow-light);
    border: 1px solid var(--border-color);
  }

  .tag-filter-title {
    font-size: 1.2rem;
    font-weight: 700;
    margin-bottom: 1rem;
    color: #c62828;
  }

  [data-theme="dark"] .tag-filter-title {
    color: #ff5252;
  }

  .tag-options {
    display: flex;
    flex-wrap: wrap;
    gap: 0.8rem;
  }

  .tag-option {
    position: relative;
  }

  .tag-option input[type="checkbox"] {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
  }

  .tag-option label {
    display: block;
    padding: 0.8rem 1.5rem;
    background: white;
    color: #333;
    border: 2px solid #e0e0e0;
    border-radius: 50px;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
    user-select: none;
  }

  [data-theme="dark"] .tag-option label {
    background: #333;
    color: #f0f0f0;
    border: 2px solid #444;
  }

  .tag-option input:checked + label {
    background: #c62828;
    color: white;
    border-color: #c62828;
    box-shadow: 0 4px 10px rgba(198, 40, 40, 0.2);
  }

  [data-theme="dark"] .tag-option input:checked + label {
    background: #ff5252;
    border-color: #ff5252;
  }

  .tag-option label:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 12px rgba(198, 40, 40, 0.15);
  }

  .form-section {
    background: var(--card-bg);
    border-radius: 16px;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    border: 1px solid var(--border-color);
    box-shadow: var(--shadow-light);
    animation: fadeIn 0.4s;
  }

  .form-section h3 {
    font-size: 1.3rem;
    margin-bottom: 1.2rem;
    color: #c62828;
    display: flex;
    align-items: center;
    gap: 0.7rem;
  }

  [data-theme="dark"] .form-section h3 {
    color: #ff5252;
  }

  textarea#suggested-news,
  .form-section textarea,
  .form-section input,
  .form-section select {
    width: 100%;
    margin-top: 0.8rem;
    padding: 1rem;
    border: 2px solid #e0e0e0;
    border-radius: 12px;
    background: white;
    color: #333;
    font-size: 1rem;
    font-weight: 500;
    resize: vertical;
    transition: all var(--transition);
    font-family: var(--font-primary);
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);
  }

  [data-theme="dark"] textarea#suggested-news,
  [data-theme="dark"] .form-section textarea,
  [data-theme="dark"] .form-section input,
  [data-theme="dark"] .form-section select {
    background: #333;
    color: #f0f0f0;
    border: 2px solid #444;
  }

  [data-theme="dark"] #editor,
  [data-theme="dark"] #article-editor {
    background: #333 !important;
    color: #f0f0f0 !important;
    border: 2px solid #444 !important;
  }

  #editor, #article-editor {
    color: #333;
  }

  .form-section input:focus,
  .form-section textarea:focus,
  .form-section select:focus {
    border-color: #c62828;
    outline: none;
    box-shadow: 0 0 0 3px rgba(198, 40, 40, 0.2);
  }

  [data-theme="dark"] .form-section input:focus,
  [data-theme="dark"] .form-section textarea:focus,
  [data-theme="dark"] .form-section select:focus {
    border-color: #ff5252;
    box-shadow: 0 0 0 3px rgba(255, 82, 82, 0.3);
  }

  .form-btn {
    background: #c62828;
    color: white;
    border: none;
    padding: 0.9rem 1.8rem;
    border-radius: 12px;
    font-weight: 700;
    font-size: 1.1rem;
    cursor: pointer;
    transition: all var(--transition);
    margin-top: 1.2rem;
    display: inline-flex;
    align-items: center;
    gap: 0.7rem;
    box-shadow: 0 4px 12px rgba(198, 40, 40, 0.25);
  }

  [data-theme="dark"] .form-btn {
    background: #ff5252;
  }

  .form-btn:hover {
    background: #8e0000;
    transform: translateY(-3px);
    box-shadow: 0 6px 16px rgba(198, 40, 40, 0.35);
  }

  [data-theme="dark"] .form-btn:hover {
    background: #ff1a1a;
  }

  .btn-group {
    display: flex;
    gap: 1.2rem;
    margin-top: 1.5rem;
    flex-wrap: wrap;
  }

  .editor-toolbar {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1rem;
    flex-wrap: wrap;
    background: white;
    border-radius: 12px;
    padding: 0.8rem;
    border: 1px solid #e0e0e0;
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);
  }

  [data-theme="dark"] .editor-toolbar {
    background: #333;
    border: 1px solid #444;
  }

  .editor-toolbar button {
    background: white;
    border: 1px solid #e0e0e0;
    color: #333;
    border-radius: 8px;
    padding: 0.6rem;
    font-size: 1.1rem;
    cursor: pointer;
    font-weight: bold;
    transition: all var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 40px;
    min-height: 40px;
  }

  [data-theme="dark"] .editor-toolbar button {
    background: #444;
    border: 1px solid #555;
    color: #f0f0f0;
  }

  .editor-toolbar button:hover,
  .editor-toolbar button:focus {
    background: #c62828;
    color: white;
    border-color: #c62828;
    transform: scale(1.05);
  }

  [data-theme="dark"] .editor-toolbar button:hover {
    background: #ff5252;
  }

  /* NEWS STYLES */
  .news {
    background: white;
    padding: 1.8rem;
    margin-bottom: 1.8rem;
    border-left: 5px solid #c62828;
    border-radius: 16px;
    box-shadow: var(--shadow-light);
    position: relative;
    transition: all var(--transition);
    animation: fadeIn 0.8s;
  }

  [data-theme="dark"] .news {
    background: #333;
    border-left: 5px solid #ff5252;
  }

  .news:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-hover);
  }

  .news-tag {
    font-weight: 800;
    color: #c62828;
    font-size: 1.1rem;
    margin-bottom: 0.8rem;
    user-select: none;
    letter-spacing: 0.03em;
    background: rgba(198, 40, 40, 0.1);
    border-radius: 50px;
    padding: 0.5rem 1.2rem;
    display: inline-block;
  }

  [data-theme="dark"] .news-tag {
    color: #ff5252;
    background: rgba(255, 82, 82, 0.15);
  }

  .news time {
    font-size: 0.9rem;
    color: #888;
    font-style: italic;
    display: block;
    margin-top: 1.5rem;
    user-select: none;
  }

  [data-theme="dark"] .news time {
    color: #aaa;
  }

  .news .actions {
    margin-top: 1.8rem;
    display: flex;
    gap: 1.2rem;
    flex-wrap: wrap;
  }

  .news .actions button {
    font-size: 1rem;
    background: #c62828;
    border: none;
    color: white;
    padding: 0.7rem 1.5rem;
    border-radius: 12px;
    cursor: pointer;
    font-weight: 700;
    box-shadow: 0 3px 8px rgba(198, 40, 40, 0.25);
    transition: all var(--transition);
    display: flex;
    align-items: center;
    gap: 0.7rem;
  }

  [data-theme="dark"] .news .actions button {
    background: #ff5252;
  }

  .news .actions button:hover {
    background: #8e0000;
    box-shadow: 0 5px 14px rgba(198, 40, 40, 0.35);
    transform: translateY(-2px);
  }

  [data-theme="dark"] .news .actions button:hover {
    background: #ff1a1a;
  }

  /* MODAL STYLES */
  #preview-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: var(--modal-bg);
    justify-content: center;
    align-items: center;
    z-index: 9999;
    user-select: none;
    animation: fadeIn 0.4s;
    backdrop-filter: var(--glass-blur);
  }

  #preview-content {
    background: white;
    color: #333;
    padding: 2.5rem;
    border-radius: 20px;
    max-width: min(90vw, 800px);
    max-height: 85vh;
    overflow-y: auto;
    box-shadow: 0 0 40px rgba(198, 40, 40, 0.3);
    user-select: text;
    position: relative;
    border: 2px solid #c62828;
  }

  [data-theme="dark"] #preview-content {
    background: #333;
    color: #f0f0f0;
    border: 2px solid #ff5252;
  }

  #preview-close {
    position: absolute;
    top: 15px;
    right: 20px;
    background: transparent;
    border: none;
    font-size: 2.2rem;
    font-weight: 300;
    color: #c62828;
    cursor: pointer;
    transition: color 0.2s;
    z-index: 222;
    line-height: 1;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  [data-theme="dark"] #preview-close {
    color: #ff5252;
  }

  #preview-close:hover {
    color: #8e0000;
    transform: scale(1.1);
  }

  [data-theme="dark"] #preview-close:hover {
    color: #ff1a1a;
  }

  /* LOGIN PANEL */
  #login-panel {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 2.5rem;
    border-radius: 20px;
    box-shadow: 0 0 40px rgba(0, 0, 0, 0.2);
    z-index: 10000;
    user-select: none;
    width: min(90vw, 400px);
    border: 2px solid #c62828;
  }

  [data-theme="dark"] #login-panel {
    background: #333;
    border: 2px solid #ff5252;
  }

  #login-panel h3 {
    color: #c62828;
    font-size: 1.8rem;
    font-weight: 700;
    text-align: center;
    margin: 0 0 1.5rem 0;
  }

  [data-theme="dark"] #login-panel h3 {
    color: #ff5252;
  }

  #login-panel input {
    width: 100%;
    padding: 1rem;
    margin-bottom: 1.5rem;
    border-radius: 12px;
    border: 2px solid #e0e0e0;
    background: white;
    color: #333;
    font-size: 1.1rem;
    transition: all var(--transition);
  }

  [data-theme="dark"] #login-panel input {
    background: #444;
    color: #f0f0f0;
    border: 2px solid #555;
  }

  #login-panel input:focus {
    border-color: #c62828;
    outline: none;
    box-shadow: 0 0 0 3px rgba(198, 40, 40, 0.2);
  }

  [data-theme="dark"] #login-panel input:focus {
    border-color: #ff5252;
    box-shadow: 0 0 0 3px rgba(255, 82, 82, 0.3);
  }

  .btns {
    display: flex;
    justify-content: center;
    gap: 1.5rem;
  }

  .btns button {
    padding: 0.8rem 1.8rem;
    border-radius: 12px;
    font-weight: 700;
    cursor: pointer;
    transition: all var(--transition);
    font-size: 1.1rem;
  }

  .btns button:first-child {
    background: #c62828;
    color: white;
    border: none;
    box-shadow: 0 4px 12px rgba(198, 40, 40, 0.25);
  }

  [data-theme="dark"] .btns button:first-child {
    background: #ff5252;
  }

  .btns button:first-child:hover {
    background: #8e0000;
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(198, 40, 40, 0.35);
  }

  .btns button:last-child {
    background: white;
    color: #333;
    border: 2px solid #e0e0e0;
  }

  [data-theme="dark"] .btns button:last-child {
    background: #444;
    color: #f0f0f0;
    border: 2px solid #555;
  }

  .btns button:last-child:hover {
    background: #f5f5f5;
  }

  [data-theme="dark"] .btns button:last-child:hover {
    background: #555;
  }

  /* SUGGESTIONS */
  #suggestions-list {
    max-height: 500px;
    overflow-y: auto;
    margin-top: 1rem;
    border: 1px solid var(--border-color);
    border-radius: 16px;
    background: var(--card-bg);
    box-shadow: var(--shadow-light);
    user-select: text;
    display: none; /* Hidden by default */
  }

  .admin-visible #suggestions-list {
    display: block; /* Visible for admins */
  }

  .suggestion-item {
    border-bottom: 1px solid var(--border-color);
    padding: 1.5rem;
    position: relative;
    font-size: 1.1rem;
    line-height: 1.6;
    word-break: break-word;
  }

  .suggestion-item:last-child {
    border-bottom: none;
  }

  .suggestion-date {
    font-size: 0.9rem;
    color: #888;
    margin-top: 0.8rem;
    font-style: italic;
  }

  [data-theme="dark"] .suggestion-date {
    color: #aaa;
  }

  .suggestion-actions {
    margin-top: 1.5rem;
    display: flex;
    gap: 1.2rem;
    justify-content: flex-end;
  }

  .suggestion-actions button {
    background: #c62828;
    border: none;
    color: #fff;
    font-size: 1rem;
    font-weight: 700;
    border-radius: 10px;
    padding: 0.7rem 1.5rem;
    cursor: pointer;
    transition: all var(--transition);
    user-select: none;
    display: flex;
    align-items: center;
    gap: 0.7rem;
    box-shadow: 0 3px 8px rgba(198, 40, 40, 0.25);
  }

  [data-theme="dark"] .suggestion-actions button {
    background: #ff5252;
  }

  .suggestion-actions button:hover {
    background: #8e0000;
    transform: translateY(-2px);
    box-shadow: 0 5px 14px rgba(198, 40, 40, 0.35);
  }

  /* NOTIFICATIONS */
  #notifications-container {
    position: fixed;
    top: 6rem;
    right: 2vw;
    max-width: 380px;
    z-index: 11001;
    user-select: none;
  }

  .notification {
    background: #c62828;
    color: #fff;
    padding: 1.2rem 1.8rem;
    margin-bottom: 1.2rem;
    border-radius: 14px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
    font-weight: 700;
    font-size: 1.1rem;
    opacity: 0;
    transform: translateX(120%);
    animation: slideIn 0.5s forwards;
    user-select: none;
    will-change: transform, opacity;
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  [data-theme="dark"] .notification {
    background: #ff5252;
  }

  .notification.success {
    background: var(--success-color);
  }

  .notification.error {
    background: #e53935;
  }

  .notification.info {
    background: var(--info-color);
  }

  @keyframes slideIn {
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes slideOut {
    to {
      opacity: 0;
      transform: translateX(130%);
    }
  }

  /* ADMIN FEATURE HIDING */
  .admin-only {
    display: none;
  }

  .admin-visible .admin-only {
    display: block;
  }

  .admin-visible .admin-inline {
    display: inline-flex;
  }
  
  /* Loading spinner */
  .loader {
    border: 4px solid rgba(0, 0, 0, 0.1);
    border-left-color: #c62828;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    animation: spin 1s linear infinite;
    margin: 2rem auto;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  /* NEW STYLES FOR SUGGESTION IMAGES */
  .suggestion-images {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-top: 1rem;
  }

  .suggestion-image {
    max-width: 100px;
    max-height: 100px;
    border-radius: 8px;
    object-fit: cover;
    border: 1px solid var(--border-color);
  }

  /* ARTICLE SECTION STYLES */
  .article-form {
    background: var(--card-bg);
    border-radius: 16px;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    border: 1px solid var(--border-color);
    box-shadow: var(--shadow-light);
  }

  .article-form h3 {
    font-size: 1.3rem;
    margin-bottom: 1.2rem;
    color: #c62828;
    display: flex;
    align-items: center;
    gap: 0.7rem;
  }

  [data-theme="dark"] .article-form h3 {
    color: #ff5252;
  }

  .article-toolbar {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1rem;
    flex-wrap: wrap;
    background: white;
    border-radius: 12px;
    padding: 0.8rem;
    border: 1px solid #e0e0e0;
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);
  }

  [data-theme="dark"] .article-toolbar {
    background: #333;
    border: 1px solid #444;
  }

  .article-toolbar button {
    background: white;
    border: 1px solid #e0e0e0;
    color: #333;
    border-radius: 8px;
    padding: 0.6rem;
    font-size: 1.1rem;
    cursor: pointer;
    font-weight: bold;
    transition: all var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 40px;
    min-height: 40px;
  }

  [data-theme="dark"] .article-toolbar button {
    background: #444;
    border: 1px solid #555;
    color: #f0f0f0;
  }

  .article-toolbar button:hover,
  .article-toolbar button:focus {
    background: #c62828;
    color: white;
    border-color: #c62828;
    transform: scale(1.05);
  }

  [data-theme="dark"] .article-toolbar button:hover {
    background: #ff5252;
  }

  #article-editor {
    min-height: 200px;
    padding: 1.2rem;
    border: 1px solid var(--border-color);
    border-radius: 12px;
    background: white;
    margin-bottom: 1.5rem;
  }

  .article-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.8rem;
    margin-top: 1rem;
  }

  .article-tag-option {
    position: relative;
  }

  .article-tag-option input[type="checkbox"] {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
  }

  .article-tag-option label {
    display: block;
    padding: 0.8rem 1.5rem;
    background: white;
    color: #333;
    border: 2px solid #e0e0e0;
    border-radius: 50px;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
    user-select: none;
  }

  [data-theme="dark"] .article-tag-option label {
    background: #333;
    color: #f0f0f0;
    border: 2px solid #444;
  }

  .article-tag-option input:checked + label {
    background: #c62828;
    color: white;
    border-color: #c62828;
    box-shadow: 0 4px 10px rgba(198, 40, 40, 0.2);
  }

  [data-theme="dark"] .article-tag-option input:checked + label {
    background: #ff5252;
    border-color: #ff5252;
  }

  .article-tag-option label:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 12px rgba(198, 40, 40, 0.15);
  }

  .pin-checkbox {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: 1rem;
    font-weight: 600;
  }

  .articles-list {
    display: grid;
    gap: 1.5rem;
    margin-top: 2rem;
  }

  .article {
    background: white;
    padding: 1.8rem;
    border-left: 5px solid #4caf50;
    border-radius: 16px;
    box-shadow: var(--shadow-light);
    position: relative;
    transition: all var(--transition);
  }

  [data-theme="dark"] .article {
    background: #333;
    border-left: 5px solid #66bb6a;
  }

  .article.pinned {
    border-left: 5px solid #ff9800;
    box-shadow: 0 4px 20px rgba(255, 152, 0, 0.25);
  }

  [data-theme="dark"] .article.pinned {
    border-left: 5px solid #ffb74d;
  }

  .article-tag {
    font-weight: 800;
    color: #4caf50;
    font-size: 1.1rem;
    margin-bottom: 0.8rem;
    user-select: none;
    letter-spacing: 0.03em;
    background: rgba(76, 175, 80, 0.1);
    border-radius: 50px;
    padding: 0.5rem 1.2rem;
    display: inline-block;
  }

  .article.pinned .article-tag {
    color: #ff9800;
    background: rgba(255, 152, 0, 0.1);
  }

  [data-theme="dark"] .article-tag {
    color: #66bb6a;
    background: rgba(102, 187, 106, 0.15);
  }

  [data-theme="dark"] .article.pinned .article-tag {
    color: #ffb74d;
    background: rgba(255, 183, 77, 0.15);
  }

  .article time {
    font-size: 0.9rem;
    color: #888;
    font-style: italic;
    display: block;
    margin-top: 1.5rem;
    user-select: none;
  }

  [data-theme="dark"] .article time {
    color: #aaa;
  }

  /* RESPONSIVE ADJUSTMENTS */
  @media (max-width: 1024px) {
    main {
      padding: calc(var(--header-height) + 1.5rem) 4% 1.5rem 4%;
    }
    
    .tag-options {
      gap: 0.6rem;
    }
    
    .tag-option label {
      padding: 0.7rem 1.2rem;
    }
  }

  @media (max-width: 768px) {
    header {
      padding: 0 1.2rem;
      font-size: 1.5rem;
    }
    
    .header-btn {
      padding: 0.6rem;
      min-width: 45px;
      height: 45px;
      justify-content: center;
    }
    
    .desktop-text {
      display: none;
    }
    
    .mobile-text {
      display: inline;
    }
    
    .section-title {
      font-size: 1.5rem;
    }
    
    section {
      padding: 1.5rem;
    }
    
    .form-section {
      padding: 1.2rem;
    }
    
    .tag-filter-container {
      padding: 1.2rem;
    }
  }

  @media (min-width: 769px) {
    .desktop-text {
      display: inline;
    }
    
    .mobile-text {
      display: none;
    }
  }

  @media (max-width: 576px) {
    #sidebar {
      width: 95%;
      padding: 1rem;
      box-sizing: border-box;
      right: -100%;
    }
    
    #sidebar.open {
      right: 0;
    }
    
    .tag-options {
      justify-content: center;
    }
    
    .news {
      padding: 1.5rem;
    }
    
    .suggestion-item {
      padding: 1.2rem;
    }
    
    .suggestion-actions {
      flex-direction: column;
      gap: 0.8rem;
    }
    
    .suggestion-actions button {
      width: 100%;
      justify-content: center;
    }
  }
  </style>
</head>

<body>
  <header>
    <button id="menu-toggle" onclick="toggleSidebar()" aria-label="–í—ñ–¥–∫—Ä–∏—Ç–∏ –º–µ–Ω—é">‚ò∞</button>
    <span>–¢–°–ù –ù–æ–≤–∏–Ω–∏</span>
    <div class="header-controls">
      <button id="theme-toggle-btn" class="header-btn" title="–ó–º—ñ–Ω–∏—Ç–∏ —Ç–µ–º—É">üåó</button>
      <button id="login-btn" class="header-btn" onclick="showLoginPanel()" title="–í—Ö—ñ–¥ –¥–ª—è –∫–æ–ø—ñ—Ä–∞–π—Ç–µ—Ä–∞">
        <span class="desktop-text">üîë –í—Ö—ñ–¥</span>
        <span class="mobile-text">üîë</span>
      </button>
      <button id="notification-toggle" class="header-btn" title="–£–≤—ñ–º–∫–Ω—É—Ç–∏/–≤–∏–º–∫–Ω—É—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è">
        <span class="desktop-text">üîî –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è</span>
        <span class="mobile-text">üîî</span>
      </button>
      <button id="logout-btn" class="header-btn admin-only" onclick="logoutWriter()" title="–í–∏–π—Ç–∏">
        <span class="desktop-text">üö™ –í–∏—Ö—ñ–¥</span>
        <span class="mobile-text">üö™</span>
      </button>
    </div>
  </header>

  <aside id="sidebar">
    <button class="sidebar-btn active" onclick="showTab('news')" aria-controls="news" aria-selected="true" role="tab" id="news-tab-btn">üì∞ –ù–æ–≤–∏–Ω–∏</button>
    <button class="sidebar-btn" onclick="showTab('submit')" aria-controls="submit" aria-selected="false" role="tab" id="submit-tab-btn">üì® –ó–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω—ñ</button>
    <button class="sidebar-btn" onclick="showTab('articles')" aria-controls="articles" aria-selected="false" role="tab" id="articles-tab-btn">üìù –°—Ç–∞—Ç—Ç—ñ</button>
    <button class="sidebar-btn admin-only" onclick="showTab('admin')" aria-controls="admin" aria-selected="false" role="tab" id="admin-tab-btn">‚öôÔ∏è –ê–¥–º—ñ–Ω</button>
  </aside>

  <main>
    <section id="news" class="active" role="tabpanel" aria-labelledby="news-tab-btn">
      <h2 class="section-title">üì∞ –û—Å—Ç–∞–Ω–Ω—ñ –Ω–æ–≤–∏–Ω–∏</h2>
      
      <div class="tag-filter-container">
        <div class="tag-filter-title">–§—ñ–ª—å—Ç—Ä –∑–∞ —Ç–µ–≥–∞–º–∏:</div>
        <div class="tag-options">
          <div class="tag-option">
            <input type="checkbox" id="tag-all" name="tag" value="all" checked onchange="renderNewsByTags()">
            <label for="tag-all">–í—Å—ñ</label>
          </div>
          <div class="tag-option">
            <input type="checkbox" id="tag-politics" name="tag" value="–ü–æ–ª—ñ—Ç–∏–∫–∞" onchange="renderNewsByTags()">
            <label for="tag-politics">–ü–æ–ª—ñ—Ç–∏–∫–∞</label>
          </div>
          <div class="tag-option">
            <input type="checkbox" id="tag-sport" name="tag" value="–°–ø–æ—Ä—Ç" onchange="renderNewsByTags()">
            <label for="tag-sport">–°–ø–æ—Ä—Ç</label>
          </div>
          <div class="tag-option">
            <input type="checkbox" id="tag-culture" name="tag" value="–ö—É–ª—å—Ç—É—Ä–∞" onchange="renderNewsByTags()">
            <label for="tag-culture">–ö—É–ª—å—Ç—É—Ä–∞</label>
          </div>
          <div class="tag-option">
            <input type="checkbox" id="tag-grp" name="tag" value="–ì–†–ü" onchange="renderNewsByTags()">
            <label for="tag-grp">–ì–†–ü</label>
          </div>
          <div class="tag-option">
            <input type="checkbox" id="tag-government" name="tag" value="–†–æ–±–æ—Ç–∞ –î–µ—Ä–∂.—Å—Ç—Ä—É–∫—Ç—É—Ä" onchange="renderNewsByTags()">
            <label for="tag-government">–î–µ—Ä–∂—Å—Ç—Ä—É–∫—Ç—É—Ä–∏</label>
          </div>
          <div class="tag-option">
            <input type="checkbox" id="tag-photo" name="tag" value="–§–æ—Ç–æ—Å–µ—Å—ñ—è" onchange="renderNewsByTags()">
            <label for="tag-photo">–§–æ—Ç–æ—Å–µ—Å—ñ—è</label>
          </div>
          <div class="tag-option">
            <input type="checkbox" id="tag-contest" name="tag" value="–ö–æ–Ω–∫—É—Ä—Å" onchange="renderNewsByTags()">
            <label for="tag-contest">–ö–æ–Ω–∫—É—Ä—Å</label>
          </div>
          <div class="tag-option">
            <input type="checkbox" id="tag-important" name="tag" value="–í–∞–∂–ª–∏–≤–µ" onchange="renderNewsByTags()">
            <label for="tag-important">–í–∞–∂–ª–∏–≤–µ</label>
          </div>
        </div>
      </div>
      
      <div id="news-feed" aria-live="polite" aria-relevant="additions">
        <div class="loader" id="news-loader"></div>
      </div>
      
      <button class="form-btn admin-only" style="background: #8e0000; margin-top: 2rem;" id="delete-all-btn" onclick="deleteAllNews()" title="–í–∏–¥–∞–ª–∏—Ç–∏ –≤—Å—ñ –Ω–æ–≤–∏–Ω–∏">
        üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏ –≤—Å—ñ –Ω–æ–≤–∏–Ω–∏
      </button>
    </section>

    <section id="submit" role="tabpanel" aria-labelledby="submit-tab-btn">
      <h2 class="section-title">üì® –ó–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω—ñ –Ω–æ–≤–∏–Ω–∏</h2>
      
      <div class="form-section">
        <h3>‚úçÔ∏è –ó–∞–ø—Ä–æ–ø–æ–Ω—É–π—Ç–µ —Å–≤–æ—é –Ω–æ–≤–∏–Ω—É</h3>
        <textarea id="suggested-news" placeholder="–í–∞—à–∞ —ñ–¥–µ—è –Ω–æ–≤–∏–Ω–∏..." rows="3"></textarea>
        <input type="file" id="suggestion-image" accept="image/*" multiple style="margin-top: 1rem;">
        <button class="form-btn" onclick="submitSuggestion()">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—é</button>
      </div>
      
      <div id="suggestions-list" aria-live="polite" aria-relevant="additions">
        <div class="loader" id="suggestions-loader"></div>
      </div>
    </section>

    <section id="articles" role="tabpanel" aria-labelledby="articles-tab-btn">
      <h2 class="section-title">üìù –°—Ç–∞—Ç—Ç—ñ</h2>
      
      <!-- –§–æ—Ä–º–∞ –¥–ª—è –Ω–∞–ø–∏—Å–∞–Ω–Ω—è —Å—Ç–∞—Ç—Ç—ñ -->
      <div class="article-form admin-only">
        <h3>‚úçÔ∏è –ù–∞–ø–∏—Å–∞—Ç–∏ —Å—Ç–∞—Ç—Ç—é</h3>
        
        <div class="article-toolbar" id="article-toolbar">
          <button type="button" title="–ñ–∏—Ä–Ω–∏–π (Ctrl+B)" onclick="format('bold', null, 'article')"><b>B</b></button>
          <button type="button" title="–ö—É—Ä—Å–∏–≤ (Ctrl+I)" onclick="format('italic', null, 'article')"><i>I</i></button>
          <button type="button" title="–ü—ñ–¥–∫—Ä–µ—Å–ª–µ–Ω–Ω—è (Ctrl+U)" onclick="format('underline', null, 'article')"><u>U</u></button>
          <button type="button" title="–°–ø–∏—Åo–∫" onclick="format('insertUnorderedList', null, 'article')">‚Ä¢ –°–ø–∏—Å–æ–∫</button>
          <button type="button" title="–ó–∞–≥–æ–ª–æ–≤–æ–∫" onclick="format('formatBlock','H3', 'article')"><span style="font-weight: 900;">H</span>3</button>
          <button type="button" title="–ü–æ—Å–∏–ª–∞–Ω–Ω—è" onclick="createLink('article')">üîó</button>
          <button type="button" title="–í—Å—Ç–∞–≤–∏—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è" onclick="promptImage('article')">üñºÔ∏è</button>
          <button type="button" title="–ü–æ –ª—ñ–≤–æ–º—É –∫—Ä–∞—é" onclick="format('justifyLeft', null, 'article')">‚óÄ</button>
          <button type="button" title="–ü–æ —Ü–µ–Ω—Ç—Ä—É" onclick="format('justifyCenter', null, 'article')">‚®Ä</button>
          <button type="button" title="–ü–æ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é" onclick="format('justifyRight', null, 'article')">‚ñ∂</button>
          <button type="button" title="–ü–æ —à–∏—Ä–∏–Ω—ñ" onclick="format('justifyFull', null, 'article')">‚Üî</button>
          <button type="button" title="–û—á–∏—Å—Ç–∏—Ç–∏ —Ñ–æ—Ä–º–∞—Ç" onclick="format('removeFormat', null, 'article')">‚úï</button>
        </div>
        
        <div id="article-editor" contenteditable="true" aria-label="–†–µ–¥–∞–∫—Ç–æ—Ä —Å—Ç–∞—Ç—Ç—ñ" role="textbox" spellcheck="true"></div>
        
        <div>
          <h3 style="margin-bottom: 1rem;">üè∑Ô∏è –í–∏–±–µ—Ä—ñ—Ç—å —Ç–µ–≥–∏:</h3>
          <div class="article-tags">
            <div class="article-tag-option">
              <input type="checkbox" id="art-useful" name="art-tag" value="–ö–æ—Ä–∏—Å–Ω–µ">
              <label for="art-useful">–ö–æ—Ä–∏—Å–Ω–µ</label>
            </div>
            <div class="article-tag-option">
              <input type="checkbox" id="art-health" name="art-tag" value="–ó–¥–æ—Ä–æ–≤—è">
              <label for="art-health">–ó–¥–æ—Ä–æ–≤—è</label>
            </div>
            <div class="article-tag-option">
              <input type="checkbox" id="art-sport" name="art-tag" value="–°–ø–æ—Ä—Ç">
              <label for="art-sport">–°–ø–æ—Ä—Ç</label>
            </div>
          </div>
        </div>
        
        <div style="margin-top: 1.5rem;">
          <label class="pin-checkbox">
            <input type="checkbox" id="pin-article">
            –ó–∞–∫—Ä—ñ–ø–∏—Ç–∏ —Å—Ç–∞—Ç—Ç—é
          </label>
        </div>
        
        <div class="btn-group">
          <button class="form-btn" onclick="publishArticle()">üì¢ –û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏</button>
          <button class="form-btn" onclick="showArticlePreview()">üëÅÔ∏è –ü–µ—Ä–µ–≥–ª—è–¥</button>
        </div>
      </div>
      
      <!-- –°–ø–∏—Å–æ–∫ —Å—Ç–∞—Ç–µ–π -->
      <div class="articles-list" id="articles-list" aria-live="polite" aria-relevant="additions">
        <div class="loader" id="articles-loader"></div>
      </div>
    </section>

    <section id="admin" class="admin-section" role="tabpanel" aria-labelledby="admin-tab-btn">
      <h2 class="section-title">‚öôÔ∏è –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä—É–≤–∞–Ω–Ω—è</h2>
      
      <div class="form-section">
        <h3>üìù –ü—É–±–ª—ñ–∫–∞—Ü—ñ—è –Ω–æ–≤–∏–Ω–∏</h3>
        
        <div class="editor-toolbar" id="editor-toolbar">
          <button type="button" title="–ñ–∏—Ä–Ω–∏–π (Ctrl+B)" onclick="format('bold')"><b>B</b></button>
          <button type="button" title="–ö—É—Ä—Å–∏–≤ (Ctrl+I)" onclick="format('italic')"><i>I</i></button>
          <button type="button" title="–ü—ñ–¥–∫—Ä–µ—Å–ª–µ–Ω–Ω—è (Ctrl+U)" onclick="format('underline')"><u>U</u></button>
          <button type="button" title="–°–ø–∏—Åo–∫" onclick="format('insertUnorderedList')">‚Ä¢ –°–ø–∏—Å–æ–∫</button>
          <button type="button" title="–ó–∞–≥–æ–ª–æ–≤–æ–∫" onclick="format('formatBlock','H3')"><span style="font-weight: 900;">H</span>3</button>
          <button type="button" title="–ü–æ—Å–∏–ª–∞–Ω–Ω—è" onclick="createLink()">üîó</button>
          <button type="button" title="–í—Å—Ç–∞–≤–∏—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è" onclick="promptImage()">üñºÔ∏è</button>
          <button type="button" title="–ü–æ –ª—ñ–≤–æ–º—É –∫—Ä–∞—é" onclick="format('justifyLeft')">‚óÄ</button>
          <button type="button" title="–ü–æ —Ü–µ–Ω—Ç—Ä—É" onclick="format('justifyCenter')">‚®Ä</button>
          <button type="button" title="–ü–æ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é" onclick="format('justifyRight')">‚ñ∂</button>
          <button type="button" title="–ü–æ —à–∏—Ä–∏–Ω—ñ" onclick="format('justifyFull')">‚Üî</button>
          <button type="button" title="–û—á–∏—Å—Ç–∏—Ç–∏ —Ñ–æ—Ä–º–∞—Ç" onclick="format('removeFormat')">‚úï</button>
        </div>
        
        <div id="editor" contenteditable="true" aria-label="–†–µ–¥–∞–∫—Ç–æ—Ä –Ω–æ–≤–∏–Ω–∏" role="textbox" spellcheck="true" style="min-height: 200px; padding: 1.2rem; border: 1px solid var(--border-color); border-radius: 12px; background: white; margin-bottom: 1.5rem;"></div>
        
        <div style="display: flex; gap: 2rem; flex-wrap: wrap;">
          <div style="flex: 1; min-width: 250px;">
            <h3 style="margin-bottom: 1rem;">üè∑Ô∏è –í–∏–±–µ—Ä—ñ—Ç—å —Ç–µ–≥–∏:</h3>
            <div class="tag-options">
              <div class="tag-option">
                <input type="checkbox" id="pub-politics" name="pub-tag" value="–ü–æ–ª—ñ—Ç–∏–∫–∞">
                <label for="pub-politics">–ü–æ–ª—ñ—Ç–∏–∫–∞</label>
              </div>
              <div class="tag-option">
                <input type="checkbox" id="pub-sport" name="pub-tag" value="–°–ø–æ—Ä—Ç">
                <label for="pub-sport">–°–ø–æ—Ä—Ç</label>
              </div>
              <div class="tag-option">
                <input type="checkbox" id="pub-culture" name="pub-tag" value="–ö—É–ª—å—Ç—É—Ä–∞">
                <label for="pub-culture">–ö—É–ª—å—Ç—É—Ä–∞</label>
              </div>
              <div class="tag-option">
                <input type="checkbox" id="pub-grp" name="pub-tag" value="–ì–†–ü">
                <label for="pub-grp">–ì–†–ü</label>
              </div>
              <div class="tag-option">
                <input type="checkbox" id="pub-government" name="pub-tag" value="–†–æ–±–æ—Ç–∞ –î–µ—Ä–∂.—Å—Ç—Ä—É–∫—Ç—É—Ä">
                <label for="pub-government">–î–µ—Ä–∂—Å—Ç—Ä—É–∫—Ç—É—Ä–∏</label>
              </div>
              <div class="tag-option">
                <input type="checkbox" id="pub-photo" name="pub-tag" value="–§–æ—Ç–æ—Å–µ—Å—ñ—è">
                <label for="pub-photo">–§–æ—Ç–æ—Å–µ—Å—ñ—è</label>
              </div>
              <div class="tag-option">
                <input type="checkbox" id="pub-contest" name="pub-tag" value="–ö–æ–Ω–∫—É—Ä—Å">
                <label for="pub-contest">–ö–æ–Ω–∫—É—Ä—Å</label>
              </div>
              <div class="tag-option">
                <input type="checkbox" id="pub-important" name="pub-tag" value="–í–∞–∂–ª–∏–≤–µ">
                <label for="pub-important">–í–∞–∂–ª–∏–≤–µ</label>
              </div>
            </div>
          </div>
          
          <div style="flex: 1; min-width: 250px;">
            <h3 style="margin-bottom: 1rem;">üñºÔ∏è –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è:</h3>
            <input type="file" id="image-upload" accept="image/*" multiple onchange="handleImageUpload(event)" style="margin-bottom: 1rem; width: 100%;" />
          </div>
        </div>
        
        <div class="btn-group">
          <button class="form-btn" onclick="publishNews()">üì¢ –û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏</button>
          <button class="form-btn" onclick="showPreview()">üëÅÔ∏è –ü–µ—Ä–µ–≥–ª—è–¥</button>
        </div>
      </div>
      
      <div class="form-section">
        <h3>üì® –ó–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω—ñ –Ω–æ–≤–∏–Ω–∏</h3>
        <div id="suggestions-list-admin" aria-live="polite" aria-relevant="additions">
          <div class="loader" id="admin-suggestions-loader"></div>
        </div>
      </div>
    </section>
  </main>

  <div id="preview-modal" onclick="hidePreview(event)" role="dialog" aria-modal="true" aria-labelledby="preview-tag" aria-describedby="preview-text">
    <div id="preview-content">
      <button id="preview-close" onclick="hidePreview(event)" aria-label="–ó–∞–∫—Ä–∏—Ç–∏ –ø–µ—Ä–µ–≥–ª—è–¥">√ó</button>
      <div class="news-tag" id="preview-tag"></div>
      <div id="preview-text"></div>
      <time id="preview-date"></time>
    </div>
  </div>

  <div id="login-panel" role="dialog" aria-modal="true" aria-labelledby="login-title">
    <h3 id="login-title">üîí –í—Ö—ñ–¥ –∫–æ–ø—ñ—Ä–∞–π—Ç–µ—Ä–∞</h3>
    <input id="writer-email" type="email" placeholder="Email" autocomplete="email" aria-label="Email –∫–æ–ø—ñ—Ä–∞–π—Ç–µ—Ä–∞" style="margin-bottom: 1rem;" />
    <input id="writer-pass" type="password" placeholder="–ü–∞—Ä–æ–ª—å" autocomplete="current-password" aria-label="–ü–∞—Ä–æ–ª—å –∫–æ–ø—ñ—Ä–∞–π—Ç–µ—Ä–∞" />
    <div class="btns">
      <button onclick="loginWriter()">–£–≤—ñ–π—Ç–∏</button>
      <button onclick="closeLoginPanel()">–í—ñ–¥–º—ñ–Ω–∞</button>
    </div>
  </div>

  <div id="notifications-container" aria-live="polite" aria-atomic="true"></div>

  <!-- Firebase SDK -->
  <script type="module">
    // Import Firebase modules
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.1/firebase-app.js";
    import { getDatabase, ref, set, push, onValue, remove, update } from "https://www.gstatic.com/firebasejs/10.12.1/firebase-database.js";
    import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.1/firebase-auth.js";

    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyATgwtUGOdNS18pKclEGSfmjFxTsjk0n88",
      authDomain: "titproject-19bfd.firebaseapp.com",
      databaseURL: "https://titproject-19bfd-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "titproject-19bfd",
      storageBucket: "titproject-19bfd.firebasestorage.app",
      messagingSenderId: "374156588962",
      appId: "1:374156588962:web:181084981068a6619aa4fb",
      measurementId: "G-DP3KFTXB4Q"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const auth = getAuth(app);

    // Create database references
    const newsRef = ref(db, 'news');
    const suggestionsRef = ref(db, 'suggestions');
    const articlesRef = ref(db, 'articles');

    // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
    let news = [];
    let suggestions = [];
    let articles = [];

    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏
    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      sidebar.classList.toggle('open');
    }

    // ---- RICH TEXT TOOLBAR ----
    function format(cmd, param, editorId = 'editor') {
      const editor = document.getElementById(editorId);
      if (editor) {
        document.execCommand(cmd, false, param);
        editor.focus();
      }
    }

    function createLink(editorId = 'editor') {
      let url = prompt("–í—Å—Ç–∞–≤—Ç–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è (URL):", "https://");
      if (url) document.execCommand("createLink", false, url.trim());
    }

    function promptImage(editorId = 'editor') {
      let url = prompt("URL –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è:");
      if (url) document.execCommand("insertImage", false, url.trim());
    }

    document.getElementById("editor").addEventListener("keydown", e => {
      if (e.ctrlKey && e.key.toLowerCase() === "b") { format('bold'); e.preventDefault(); }
      if (e.ctrlKey && e.key.toLowerCase() === "i") { format('italic'); e.preventDefault(); }
      if (e.ctrlKey && e.key.toLowerCase() === "u") { format('underline'); e.preventDefault(); }
    });

    document.getElementById("article-editor").addEventListener("keydown", e => {
      if (e.ctrlKey && e.key.toLowerCase() === "b") { format('bold', null, 'article'); e.preventDefault(); }
      if (e.ctrlKey && e.key.toLowerCase() === "i") { format('italic', null, 'article'); e.preventDefault(); }
      if (e.ctrlKey && e.key.toLowerCase() === "u") { format('underline', null, 'article'); e.preventDefault(); }
    });

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    function handleImageUpload(event) {
      const files = event.target.files;
      if (!files || files.length === 0) return;
      
      const editor = document.getElementById('editor');
      const reader = new FileReader();
      
      const processFile = (file, index) => {
        return new Promise((resolve) => {
          reader.onload = function (e) {
            const imgElem = document.createElement('img');
            imgElem.src = e.target.result;
            imgElem.style.maxWidth = "100%";
            imgElem.style.borderRadius = "12px";
            imgElem.style.marginTop = "1rem";
            imgElem.style.display = "block";
            editor.appendChild(imgElem);
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Ä–∞–∑—Ä—ã–≤ –ø–æ—Å–ª–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            if (index < files.length - 1) {
              editor.appendChild(document.createElement('br'));
            }
            resolve();
          };
          reader.readAsDataURL(file);
        });
      };
      
      // –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤
      (async function() {
        for (let i = 0; i < files.length; i++) {
          await processFile(files[i], i);
        }
      })();
    }

    function handleArticleImageUpload(event) {
      const files = event.target.files;
      if (!files || files.length === 0) return;
      
      const editor = document.getElementById('article-editor');
      const reader = new FileReader();
      
      const processFile = (file, index) => {
        return new Promise((resolve) => {
          reader.onload = function (e) {
            const imgElem = document.createElement('img');
            imgElem.src = e.target.result;
            imgElem.style.maxWidth = "100%";
            imgElem.style.borderRadius = "12px";
            imgElem.style.marginTop = "1rem";
            imgElem.style.display = "block";
            editor.appendChild(imgElem);
            
            if (index < files.length - 1) {
              editor.appendChild(document.createElement('br'));
            }
            resolve();
          };
          reader.readAsDataURL(file);
        });
      };
      
      (async function() {
        for (let i = 0; i < files.length; i++) {
          await processFile(files[i], i);
        }
      })();
    }

    // ---- –¢–∞–±—ã/–ø–∞–Ω–µ–ª–∏ ----
    function showTab(tabId) {
      // –°–Ω–∏–º–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
      document.querySelectorAll('aside button').forEach(btn => {
        btn.classList.remove('active');
      });
      
      // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Ç–µ–∫—É—â–µ–π –∫–Ω–æ–ø–∫–µ
      document.getElementById(`${tabId}-tab-btn`).classList.add('active');
      
      // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å–µ–∫—Ü–∏–∏
      document.querySelectorAll('main>section').forEach(section => {
        section.classList.remove('active');
      });
    
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å–µ–∫—Ü–∏—é
      document.getElementById(tabId).classList.add('active');
    }

    function showLoginPanel() {
      document.getElementById('login-panel').style.display = 'block';
      document.getElementById('writer-email').focus();
    }

    function closeLoginPanel() { 
      document.getElementById('login-panel').style.display = 'none'; 
    }

    // –§—É–Ω–∫—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞—Ç—ã –≤ 24-—á–∞—Å–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
    function formatDate(date) {
      return new Date(date).toLocaleString('uk-UA', {
        day: '2-digit',
        month: '2-digit',
        year: 'numeric',
        hour: '2-digit',
        minute: '2-digit',
        hour12: false
      });
    }

    // –í—Ö–æ–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
    async function loginWriter() {
      const email = document.getElementById('writer-email').value.trim();
      const password = document.getElementById('writer-pass').value.trim();

      if (!email || !password) {
        showNotification("–í–≤–µ–¥—ñ—Ç—å email —Ç–∞ –ø–∞—Ä–æ–ª—å", "error");
        return;
      }

      try {
        const userCredential = await signInWithEmailAndPassword(auth, email, password);
        showNotification("–£—Å–ø—ñ—à–Ω–∏–π –≤—Ö—ñ–¥!", "success");
        closeLoginPanel();
      } catch (error) {
        console.error("–ü–æ–º–∏–ª–∫–∞ –≤—Ö–æ–¥—É:", error);
        const errorMap = {
          'auth/invalid-credential': '–ù–µ–≤—ñ—Ä–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ',
          'auth/user-not-found': '–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ',
          'auth/wrong-password': '–ù–µ–≤—ñ—Ä–Ω–∏–π –ø–∞—Ä–æ–ª—å',
          'auth/invalid-email': '–ù–µ–≤—ñ—Ä–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç email',
          'auth/user-disabled': '–ê–∫–∞—É–Ω—Ç –≤–∏–º–∫–Ω–µ–Ω–∏–π',
          'auth/too-many-requests': '–ó–∞–±–∞–≥–∞—Ç–æ —Å–ø—Ä–æ–±. –°–ø—Ä–æ–±—É–π—Ç–µ –ø—ñ–∑–Ω—ñ—à–µ'
        };
        const errorMessage = errorMap[error.code] || `–ü–æ–º–∏–ª–∫–∞ –≤—Ö–æ–¥—É: ${error.message}`;
        showNotification(errorMessage, "error");
      }
    }

    // –í—ã—Ö–æ–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
    function logoutWriter() {
      signOut(auth).then(() => {
        showNotification("–í–∏ –≤–∏–π—à–ª–∏ –∑ —Å–∏—Å—Ç–µ–º–∏", "info");
      }).catch((error) => {
        showNotification("–ü–æ–º–∏–ª–∫–∞ –≤–∏—Ö–æ–¥—É: " + error.message, "error");
      });
    }

    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ UI –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
    function toggleAdminUI(loggedIn) {
      if (loggedIn) {
        document.body.classList.add('admin-visible');
      } else {
        document.body.classList.remove('admin-visible');
      }
    }

    window.onclick = function (e) { 
      if (e.target === document.getElementById('login-panel')) {
        closeLoginPanel();
      }
    };

    // ---- –ü–†–ï–î–õ–û–ñ–ï–ù–ò–Ø (suggestions) ----
    function submitSuggestion() {
      let text = document.getElementById('suggested-news').value.trim();
      if (!text) { 
        showNotification("–í–≤–µ–¥—ñ—Ç—å –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—é!", "error"); 
        return; 
      }
      
      const files = document.getElementById('suggestion-image').files;
      const images = [];
      
      if (files.length > 0) {
        const reader = new FileReader();
        
        const processFile = (file, index) => {
          return new Promise((resolve) => {
            reader.onload = function (e) {
              images.push(e.target.result);
              resolve();
            };
            reader.readAsDataURL(file);
          });
        };
        
        (async function() {
          try {
            for (let i = 0; i < files.length; i++) {
              await processFile(files[i], i);
            }
            
            const newSuggestionRef = push(suggestionsRef);
            await set(newSuggestionRef, {
              text,
              images: images.length > 0 ? images : [],
              date: formatDate(new Date())
            });
            
            document.getElementById('suggested-news').value = "";
            document.getElementById('suggestion-image').value = "";
            showNotification("–î—è–∫—É—î–º–æ –∑–∞ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—é!", "success");
          } catch (error) {
            console.error("–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó:", error);
            showNotification("–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è: " + error.message, "error");
          }
        })();
      } else {
        const newSuggestionRef = push(suggestionsRef);
        set(newSuggestionRef, {
          text,
          images: [],
          date: formatDate(new Date())
        }).then(() => {
          document.getElementById('suggested-news').value = "";
          showNotification("–î—è–∫—É—î–º–æ –∑–∞ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—é!", "success");
        }).catch((error) => {
          console.error("–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó:", error);
          showNotification("–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è: " + error.message, "error");
        });
      }
    }

    function renderSuggestions(suggestions) {
      const list = document.getElementById('suggestions-list');
      const adminList = document.getElementById('suggestions-list-admin');
      
      if (!list && !adminList) return;
      
      const suggestionHTML = suggestions.length
        ? suggestions.map((s, i) => {
            const images = s.images || [];
            return `
              <div class="suggestion-item">
                <div>${s.text}</div>
                ${images.length ? `
                  <div class="suggestion-images">
                    ${images.map(img => `<img src="${img}" class="suggestion-image" alt="–ü—Ä–æ–ø–æ–∑–∏—Ü—ñ—è">`).join('')}
                  </div>
                ` : ''}
                <div class="suggestion-date">${s.date}</div>
                <div class="suggestion-actions admin-only">
                  <button onclick="publishSuggestion('${s.id}')">üì¢ –ü—É–±–ª—ñ–∫—É–≤–∞—Ç–∏</button>
                  <button class="admin-only" onclick="deleteSuggestion('${s.id}')">üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏</button>
                </div>
              </div>
            `;
          }).join('')
        : '<div style="padding:2rem;color:var(--text-color);text-align:center;opacity:0.7;">–ù–µ–º–∞—î –∑–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω–∏—Ö –Ω–æ–≤–∏–Ω.</div>';
      
      if (list) list.innerHTML = suggestionHTML;
      if (adminList) adminList.innerHTML = suggestionHTML;
    }

    function deleteSuggestion(id) {
      if (confirm('–í–∏–¥–∞–ª–∏—Ç–∏ —Ü—é –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—é?')) {
        const suggestionRef = ref(db, `suggestions/${id}`);
        remove(suggestionRef)
          .then(() => {
            showNotification("–ü—Ä–æ–ø–æ–∑–∏—Ü—ñ—é –≤–∏–¥–∞–ª–µ–Ω–æ", "success");
          })
          .catch((error) => {
            showNotification("–ü–æ–º–∏–ª–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è: " + error.message, "error");
          });
      }
    }

    function publishSuggestion(id) {
      const suggestionRef = ref(db, `suggestions/${id}`);
      
      onValue(suggestionRef, (snapshot) => {
        const s = snapshot.val();
        if (s) {
          document.getElementById('editor').innerHTML = s.text;
          
          if (s.images && s.images.length > 0) {
            s.images.forEach(img => {
              const imgElem = document.createElement('img');
              imgElem.src = img;
              imgElem.style.maxWidth = "100%";
              imgElem.style.borderRadius = "12px";
              imgElem.style.marginTop = "1rem";
              imgElem.style.display = "block";
              document.getElementById('editor').appendChild(imgElem);
              document.getElementById('editor').appendChild(document.createElement('br'));
            });
          }
          
          remove(suggestionRef);
          showTab('admin');
          showNotification("–ü—Ä–æ–ø–æ–∑–∏—Ü—ñ—é –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä", "info");
        }
      }, { onlyOnce: true });
    }

    // --- –¢–ï–ú–ê Toggle ---
    document.getElementById('theme-toggle-btn').onclick = () => {
      let d = document.documentElement;
      let now = d.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
      d.setAttribute('data-theme', now);
      localStorage.setItem('theme', now);
      showNotification(`–¢–µ–º–∞ –∑–º—ñ–Ω–µ–Ω–∞ –Ω–∞ ${now === 'dark' ? '—Ç–µ–º–Ω—É' : '—Å–≤—ñ—Ç–ª—É'}`, "info");
    };

    // ---- –ü–£–ë–õ–ò–ö–ê–¶–ò–Ø –ù–û–í–û–°–¢–ï–ô (ADMIN) ----
    function publishNews() {
      const selectedTags = Array.from(document.querySelectorAll('input[name="pub-tag"]:checked'))
        .map(checkbox => checkbox.value);
      
      if (selectedTags.length === 0) {
        showNotification("–í–∏–±–µ—Ä—ñ—Ç—å —Ö–æ—á–∞ –± –æ–¥–∏–Ω —Ç–µ–≥!", "error");
        return;
      }
      
      let html = document.getElementById('editor').innerHTML.trim();
      if (html.length < 10) { 
        showNotification("–î—É–∂–µ –∫–æ—Ä–æ—Ç–∫–∞ –Ω–æ–≤–∏–Ω–∞!", "error"); 
        return; 
      }
      
      const newNewsRef = push(newsRef);
      set(newNewsRef, {
        tags: selectedTags,
        html,
        date: formatDate(new Date())
      }).then(() => {
        showNotification("–ù–æ–≤–∏–Ω—É –æ–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–æ!", "success");
        document.getElementById('editor').innerHTML = "";
        document.getElementById('image-upload').value = "";
        document.querySelectorAll('input[name="pub-tag"]').forEach(cb => cb.checked = false);
        showTab('news');
      }).catch((error) => {
        showNotification("–ü–æ–º–∏–ª–∫–∞ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó: " + error.message, "error");
      });
    }

    function renderNews(news) {
      let feed = document.getElementById('news-feed');
      if (!feed) return;
      
      // –°–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–æ–≤–æ—Å—Ç–∏ –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–Ω–∞—á–∞–ª–∞)
      const sortedNews = [...news].sort((a, b) => {
        return new Date(b.date) - new Date(a.date);
      });
      
      const selectedTags = Array.from(document.querySelectorAll('input[name="tag"]:checked'))
        .map(checkbox => checkbox.value);
      
      const filteredNews = (selectedTags.includes('all') || selectedTags.length === 0) 
        ? sortedNews 
        : sortedNews.filter(n => n.tags.some(tag => selectedTags.includes(tag)));
      
      feed.innerHTML = filteredNews.length
        ? filteredNews.map((n, i) => `
          <div class="news" id="news-${n.id}">
            <div class="news-tag">${n.tags.map(tag => tag).join(', ')}</div>
            <div class="news-text">${n.html}</div>
            <time>${n.date ?? ""}</time>
            <div class="actions">
              <button onclick="copyNewsLink('${n.id}')">üîó –ö–æ–ø—ñ—é–≤–∞—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è</button>
              <button class="admin-only" onclick="showPreviewFromFeed('${n.id}')">üëÅÔ∏è –ü–µ—Ä–µ–≥–ª—è–¥</button>
              <button class="admin-only" onclick="deleteNews('${n.id}')">üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏</button>
            </div>
          </div>
        `).join('')
        : '<div style="padding:2rem;color:var(--text-color);text-align:center;opacity:0.7;">–ù–æ–≤–∏–Ω –∑–∞ –æ–±—Ä–∞–Ω–∏–º–∏ —Ç–µ–≥–∞–º–∏ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ.</div>';
      
      document.getElementById('delete-all-btn').hidden = !filteredNews.length;
    }
    
    function copyNewsLink(id) {
      const url = window.location.href.split('#')[0] + `#news-${id}`;
      navigator.clipboard.writeText(url).then(() => {
        showNotification("–ü–æ—Å–∏–ª–∞–Ω–Ω—è —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ!", "success");
      });
    }

    function deleteNews(id) {
      if (confirm('–í–∏–¥–∞–ª–∏—Ç–∏ –Ω–æ–≤–∏–Ω—É?')) {
        const newsRef = ref(db, `news/${id}`);
        remove(newsRef)
          .then(() => {
            showNotification("–ù–æ–≤–∏–Ω—É –≤–∏–¥–∞–ª–µ–Ω–æ", "success");
          })
          .catch((error) => {
            showNotification("–ü–æ–º–∏–ª–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è: " + error.message, "error");
          });
      }
    }

    function deleteAllNews() {
      if (confirm('–í–∏–¥–∞–ª–∏—Ç–∏ –≤—Å—ñ –Ω–æ–≤–∏–Ω–∏ –±–µ–∑–ø–æ–≤–æ—Ä–æ—Ç–Ω–æ?')) {
        remove(newsRef)
          .then(() => {
            showNotification("–í—Å—ñ –Ω–æ–≤–∏–Ω–∏ –≤–∏–¥–∞–ª–µ–Ω–æ", "success");
          })
          .catch((error) => {
            showNotification("–ü–æ–º–∏–ª–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è: " + error.message, "error");
          });
      }
    }

    function renderNewsByTags() {
      renderNews(news);
    }

  // ---- –°–¢–ê–¢–¨–ò ----
function publishArticle() {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
    const user = auth.currentUser;
    if (!user) {
        showNotification("–í–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ñ –¥–ª—è –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó —Å—Ç–∞—Ç–µ–π", "error");
        return;
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–æ–±–∞–≤—å—Ç–µ —Å–≤–æ—é –ª–æ–≥–∏–∫—É –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤)
    if (!user.emailVerified) {
        showNotification("–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –ø—Ä–∞–≤ –¥–ª—è –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó —Å—Ç–∞—Ç–µ–π", "error");
        return;
    }

    const selectedTags = Array.from(document.querySelectorAll('input[name="art-tag"]:checked'))
        .map(checkbox => checkbox.value);
    
    if (selectedTags.length === 0) {
        showNotification("–í–∏–±–µ—Ä—ñ—Ç—å —Ö–æ—á–∞ –± –æ–¥–∏–Ω —Ç–µ–≥!", "error");
        return;
    }
    
    let html = document.getElementById('article-editor').innerHTML.trim();
    if (html.length < 10) { 
        showNotification("–°—Ç–∞—Ç—Ç—è –∑–∞–Ω–∞–¥—Ç–æ –∫–æ—Ä–æ—Ç–∫–∞!", "error"); 
        return; 
    }
    
    const pinned = document.getElementById('pin-article').checked;
    const imageFile = document.getElementById('article-image-upload')?.files[0];
    
    // –ï—Å–ª–∏ –µ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –µ–≥–æ
    if (imageFile) {
        const reader = new FileReader();
        
        reader.onload = function(e) {
            const imageUrl = e.target.result;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–∞—Ç—å—é —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º
            saveArticle({
                tags: selectedTags,
                html: `<div class="article-image-container"><img src="${imageUrl}" alt="–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Å—Ç–∞—Ç—Ç—ñ" class="article-image"></div>${html}`,
                pinned,
                date: formatDate(new Date()),
                author: user.uid
            });
        };
        
        reader.readAsDataURL(imageFile);
    } else {
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–∞—Ç—å—é –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        saveArticle({
            tags: selectedTags,
            html,
            pinned,
            date: formatDate(new Date()),
            author: user.uid
        });
    }
}

function saveArticle(articleData) {
    const newArticleRef = push(articlesRef);
    set(newArticleRef, articleData)
        .then(() => {
            showNotification("–°—Ç–∞—Ç—Ç—é –æ–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–æ!", "success");
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
            document.getElementById('article-editor').innerHTML = "";
            document.querySelectorAll('input[name="art-tag"]').forEach(cb => cb.checked = false);
            document.getElementById('pin-article').checked = false;
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            if (document.getElementById('article-image-upload')) {
                document.getElementById('article-image-upload').value = "";
            }
        })
        .catch((error) => {
            console.error("–ü–æ–º–∏–ª–∫–∞ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó —Å—Ç–∞—Ç—Ç—ñ:", error);
            showNotification("–ü–æ–º–∏–ª–∫–∞ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó: " + error.message, "error");
        });
}

function renderArticles(articles) {
    const list = document.getElementById('articles-list');
    if (!list) return;
    
    // –°–æ—Ä—Ç–∏—Ä—É–µ–º: –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–µ –≤–≤–µ—Ä—Ö—É, –∑–∞—Ç–µ–º –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–Ω–∞—á–∞–ª–∞)
    const sortedArticles = [...articles].sort((a, b) => {
        if (a.pinned && !b.pinned) return -1;
        if (!a.pinned && b.pinned) return 1;
        return new Date(b.date) - new Date(a.date);
    });
    
    list.innerHTML = sortedArticles.length
        ? sortedArticles.map(article => `
            <div class="article ${article.pinned ? 'pinned' : ''}" id="article-${article.id}">
                <div class="article-tag">${article.tags.join(', ')}</div>
                <div class="news-text">${article.html}</div>
                <time>${article.date}</time>
                <div class="actions admin-only">
                    <button onclick="copyArticleLink('${article.id}')">üîó –ö–æ–ø—ñ—é–≤–∞—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è</button>
                    <button onclick="deleteArticle('${article.id}')">üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏</button>
                </div>
            </div>
        `).join('')
        : '<div style="padding:2rem;color:var(--text-color);text-align:center;opacity:0.7;">–°—Ç–∞—Ç–µ–π —â–µ –Ω–µ–º–∞—î.</div>';
}

function copyArticleLink(id) {
    const url = window.location.href.split('#')[0] + `#article-${id}`;
    navigator.clipboard.writeText(url).then(() => {
        showNotification("–ü–æ—Å–∏–ª–∞–Ω–Ω—è —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ!", "success");
    });
}

function deleteArticle(id) {
    if (confirm('–í–∏–¥–∞–ª–∏—Ç–∏ —Å—Ç–∞—Ç—Ç—é?')) {
        const articleRef = ref(db, `articles/${id}`);
        remove(articleRef)
            .then(() => {
                showNotification("–°—Ç–∞—Ç—Ç—é –≤–∏–¥–∞–ª–µ–Ω–æ", "success");
            })
            .catch((error) => {
                showNotification("–ü–æ–º–∏–ª–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è: " + error.message, "error");
            });
    }
}

function showArticlePreview() {
    const selectedTags = Array.from(document.querySelectorAll('input[name="art-tag"]:checked'))
        .map(checkbox => checkbox.value);
    
    if (selectedTags.length === 0) {
        showNotification("–í–∏–±–µ—Ä—ñ—Ç—å —Ö–æ—á–∞ –± –æ–¥–∏–Ω —Ç–µ–≥!", "error");
        return;
    }
    
    let html = document.getElementById('article-editor').innerHTML.trim();
    const imageFile = document.getElementById('article-image-upload')?.files[0];
    
    if (imageFile) {
        const reader = new FileReader();
        reader.onload = function(e) {
            const imageUrl = e.target.result;
            showArticlePreviewContent(selectedTags, `<div class="article-image-container"><img src="${imageUrl}" alt="–ü—Ä–µ–≤'—é –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è" class="article-image"></div>${html}`);
        };
        reader.readAsDataURL(imageFile);
    } else {
        showArticlePreviewContent(selectedTags, html);
    }
}

function showArticlePreviewContent(selectedTags, html) {
    document.getElementById('preview-tag').innerText = selectedTags.join(', ');
    document.getElementById('preview-text').innerHTML = html;
    document.getElementById('preview-date').innerText = formatDate(new Date());
    document.getElementById('preview-modal').style.display = 'flex';
}

    // ---- –ü–†–ï–î–ü–†–û–°–ú–û–¢–† (modal) ----
    function showPreview() {
      const selectedTags = Array.from(document.querySelectorAll('input[name="pub-tag"]:checked'))
        .map(checkbox => checkbox.value);
      
      if (selectedTags.length === 0) {
        showNotification("–í–∏–±–µ—Ä—ñ—Ç—å —Ö–æ—á–∞ –± –æ–¥–∏–Ω —Ç–µ–≥!", "error");
        return;
      }
      
      let html = document.getElementById('editor').innerHTML.trim();
      
      document.getElementById('preview-tag').innerText = selectedTags.join(', ');
      document.getElementById('preview-text').innerHTML = html;
      document.getElementById('preview-date').innerText = formatDate(new Date());
      document.getElementById('preview-modal').style.display = 'flex';
    }

    function showPreviewFromFeed(id) {
      const newsItemRef = ref(db, `news/${id}`);
      onValue(newsItemRef, (snapshot) => {
        const n = snapshot.val();
        if (n) {
          document.getElementById('preview-tag').innerText = n.tags.join(', ');
          document.getElementById('preview-text').innerHTML = n.html;
          document.getElementById('preview-date').innerText = n.date;
          document.getElementById('preview-modal').style.display = 'flex';
        }
      }, { onlyOnce: true });
    }

    function hidePreview(e) {
      if (!e || e.target === document.getElementById('preview-modal') || e.target.id === "preview-close")
        document.getElementById('preview-modal').style.display = 'none';
    }

    // ---- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è ----
    function showNotification(txt, type = "info") {
      let c = document.getElementById('notifications-container');
      let d = document.createElement('div');
      d.className = 'notification ' + type;
      d.innerText = txt;
      c.appendChild(d);
      setTimeout(() => { d.style.animation = "slideOut .42s forwards"; }, 3000);
      setTimeout(() => { if (d.parentNode) c.removeChild(d); }, 3500);
    }

    // ---- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: permission toggle ----
    document.getElementById('notification-toggle').onclick = function () {
      let btn = this;
      if (btn.classList.contains('active')) {
        btn.classList.remove('active'); 
        btn.innerHTML = '<span class="desktop-text">üîî –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è</span><span class="mobile-text">üîî</span>';
        localStorage.setItem('notifications', '0');
        showNotification("–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤–∏–º–∫–Ω–µ–Ω—ñ", "info");
      } else {
        btn.classList.add('active'); 
        btn.innerHTML = '<span class="desktop-text">üîï –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è</span><span class="mobile-text">üîï</span>';
        localStorage.setItem('notifications', '1');
        showNotification("–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤–≤—ñ–º–∫–Ω–µ–Ω—ñ!", "success");
      }
    };

    // ---- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø (–∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ) ----
    document.addEventListener('DOMContentLoaded', () => {
      // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–º—ã
      let savedTheme = localStorage.getItem('theme');
      if (savedTheme) document.documentElement.setAttribute('data-theme', savedTheme);
      
      // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –Ω–æ–≤–æ—Å—Ç–∏
      onValue(newsRef, (snapshot) => {
        const newsData = snapshot.val();
        news = newsData ? Object.keys(newsData).map(key => ({ 
          id: key, 
          ...newsData[key],
          date: formatDate(new Date(newsData[key].date || Date.now()))
        })).sort((a, b) => new Date(b.date) - new Date(a.date)) : [];
        renderNews(news);
        document.getElementById('news-loader').style.display = 'none';
      }, (error) => {
        console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–æ–≤–æ—Å—Ç–µ–π:", error);
        document.getElementById('news-loader').style.display = 'none';
      });
      
      // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
      onValue(suggestionsRef, (snapshot) => {
        try {
          const suggestionsData = snapshot.val();
          suggestions = suggestionsData ? Object.keys(suggestionsData).map(key => ({ 
            id: key, 
            ...suggestionsData[key]
          })) : [];
          
          renderSuggestions(suggestions);
          
          if (document.getElementById('suggestions-loader')) {
            document.getElementById('suggestions-loader').style.display = 'none';
          }
          if (document.getElementById('admin-suggestions-loader')) {
            document.getElementById('admin-suggestions-loader').style.display = 'none';
          }
        } catch (error) {
          console.error("–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π:", error);
          showNotification("–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ–π", "error");
        }
      }, (error) => {
        console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π:", error);
        showNotification("–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ–π", "error");
      });

      // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å—Ç–∞—Ç—å–∏
      onValue(articlesRef, (snapshot) => {
        const articlesData = snapshot.val();
        articles = articlesData ? Object.keys(articlesData).map(key => ({ 
          id: key, 
          ...articlesData[key]
        })) : [];
        renderArticles(articles);
        document.getElementById('articles-loader').style.display = 'none';
      }, (error) => {
        console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–µ–π:", error);
        document.getElementById('articles-loader').style.display = 'none';
      });
      
      // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
      onAuthStateChanged(auth, (user) => {
        toggleAdminUI(!!user);
      });
      
      // –ê–¥–∞–ø—Ç–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
      function adaptForMobile() {
        const isMobile = window.innerWidth <= 768;
        document.querySelectorAll('.desktop-text').forEach(el => {
          el.style.display = isMobile ? 'none' : 'inline';
        });
        document.querySelectorAll('.mobile-text').forEach(el => {
          el.style.display = isMobile ? 'inline' : 'none';
        });
      }
      
      // –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è
      adaptForMobile();
      
      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
      window.addEventListener('resize', adaptForMobile);
      
      // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
      if (localStorage.getItem('notifications') === '1') {
        document.getElementById('notification-toggle').classList.add('active');
        document.getElementById('notification-toggle').innerHTML = '<span class="desktop-text">üîï –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è</span><span class="mobile-text">üîï</span>';
      }
      
      // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –Ω–æ–≤–æ—Å—Ç–∏ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —è–∫–æ—Ä—è –≤ URL
      if (window.location.hash) {
        const newsElement = document.querySelector(window.location.hash);
        if (newsElement) {
          setTimeout(() => {
            newsElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
          }, 500);
        }
      }
    });

    // –°–¥–µ–ª–∞–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–º–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã –∏–∑ HTML
    window.toggleSidebar = toggleSidebar;
    window.showTab = showTab;
    window.showLoginPanel = showLoginPanel;
    window.closeLoginPanel = closeLoginPanel;
    window.loginWriter = loginWriter;
    window.logoutWriter = logoutWriter;
    window.submitSuggestion = submitSuggestion;
    window.publishSuggestion = publishSuggestion;
    window.deleteSuggestion = deleteSuggestion;
    window.publishNews = publishNews;
    window.deleteNews = deleteNews;
    window.deleteAllNews = deleteAllNews;
    window.renderNewsByTags = renderNewsByTags;
    window.showPreview = showPreview;
    window.showPreviewFromFeed = showPreviewFromFeed;
    window.hidePreview = hidePreview;
    window.copyNewsLink = copyNewsLink;
    window.format = format;
    window.createLink = createLink;
    window.promptImage = promptImage;
    window.handleImageUpload = handleImageUpload;
    window.publishArticle = publishArticle;
    window.deleteArticle = deleteArticle;
    window.copyArticleLink = copyArticleLink;
    window.showArticlePreview = showArticlePreview;
  </script>
</body>
</html>
